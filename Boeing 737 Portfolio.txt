\documentclass[11pt, a4paper]{article}

% --- PREAMBLE ---
\usepackage[a4paper, top=2.5cm, bottom=2.5cm, left=2cm, right=2cm]{geometry}
\usepackage{fontspec}
\usepackage[english, bidi=basic, provide=*]{babel}
\babelprovide[import, onchar=ids fonts]{english}
\babelfont{rm}{Noto Sans}

% Standard Formatting
\usepackage{enumitem}
\setlist[itemize]{label=-}
\usepackage{titlesec}
\usepackage{xcolor}
\usepackage{parskip}
\usepackage{booktabs}
\usepackage{fancyhdr}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{float} % Required for precise image placement

% Boeing Brand Colors
\definecolor{boeingblue}{HTML}{0039A6}
\definecolor{skyblue}{HTML}{00A3E0}
\definecolor{safetyred}{HTML}{D62620}
\definecolor{techgray}{RGB}{245, 245, 245}
\definecolor{codeblack}{RGB}{20, 20, 20}

% Styling
\titleformat{\section}{\color{boeingblue}\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\color{codeblack}\normalfont\large\bfseries}{\thesubsection}{1em}{}

% Code Block Styling
\lstset{
  backgroundcolor=\color{techgray},
  basicstyle=\ttfamily\footnotesize\color{codeblack},
  breaklines=true,
  frame=l,
  framesep=8pt,
  rulecolor=\color{boeingblue},
  captionpos=b,
  keywordstyle=\color{boeingblue}\bfseries,
  commentstyle=\color{gray}\itshape
}

% Header/Footer
\setlength{\headheight}{14pt}
\pagestyle{fancy}
\fancyhf{}
\rhead{\textbf{Boeing 737 Reliability Analysis}}
\lhead{ATA 32 Landing Gear System}
\rfoot{Page \thepage}

% Title
\title{\textbf{\color{boeingblue}Technical Case Study: Boeing 737 Fleet Reliability} \\ \large Root Cause Analysis \& Predictive Maintenance (ATA 32)}
\author{\textbf{Role:} Data Analyst / Analytics Engineer \\ \textbf{Tech Stack:} SQL (MySQL), Power BI, DAX, Power Query}
\date{\today}

\begin{document}

\maketitle

\section{Executive Summary}
\textbf{Objective:} Optimize unscheduled maintenance planning by identifying root causes of defects in the Boeing 737 Landing Gear system.

\textbf{Outcome:} Engineered an end-to-end analytics pipeline processing 500+ FAA Service Difficulty Reports. The solution revealed a \textbf{40\% seasonal failure spike} and identified that \textbf{96\% of defects resulted in immediate Aircraft on Ground (AOG)} status. This insight shifted the maintenance strategy from reactive repairs to predictive resource allocation.

% --- IMAGE 1: DASHBOARD MAIN ---
% REPLACE THE CODE BELOW WITH: \includegraphics[width=\textwidth]{dashboard_main.png}
\begin{figure}[h!]
  \centering
  \framebox{\parbox{0.9\textwidth}{\centering
    \vspace{3cm}
    \textbf{INSERT SCREENSHOT: dashboard\_main.png} \\
    \small\textit{Show the Executive View with KPI Cards and Trend Line.}
    \vspace{3cm}
  }}
  \caption{Final Power BI Dashboard: Single-Pane-of-Glass Executive View.}
  \label{fig:dashboard}
\end{figure}

\section{The Business Challenge}
Maintenance teams were reacting to failures blindly. Data was locked in unstructured, text-heavy regulatory reports, causing:
\begin{itemize}
    \item \textbf{Operational Disruption:} 473 out of 491 defects resulted in immediate AOG status.
    \item \textbf{Safety Blind Spots:} Lack of insight into "Climb Phase" failures (retraction risks).
    \item \textbf{Resource Misallocation:} Mechanics treated "Nuisance" sensor errors with the same urgency as structural failures.
\end{itemize}

\section{Technical Architecture: The "Vacuum Method" (ETL)}
\textbf{The Solution:} I engineered a "Vacuum Method" strategy in Power Query/SQL to ensure zero data loss from the messy FAA source files.

\begin{enumerate}[itemsep=0.8em] % Increased spacing for readability
    \item \textbf{Force Text Import:} Manually set all columns to \texttt{TEXT} to bypass strict type-checking.
    \item \textbf{Null Handling:} Replaced blanks in \texttt{AircraftTotalTime} with "0" to preserve row counts without risky imputation.
    \item \textbf{Type Casting:} Converted cleaned columns back to numeric types for analysis.
\end{enumerate}

\begin{minipage}{\linewidth} % Prevent page break
\begin{lstlisting}[language=SQL, caption=SQL Schema Strategy]
CREATE TABLE sdr_landing_gear (
    UniqueControlNumber VARCHAR(50) PRIMARY KEY,
    DifficultyDate TEXT, -- Imported as TEXT to handle format issues
    AircraftSerialNumber VARCHAR(50), -- Mixed types handled here
    ...
);
\end{lstlisting}
\end{minipage}

\clearpage % Force page break for structure

\section{Data Modeling: Star Schema}
To enable multi-dimensional analysis, a Star Schema was constructed:
\begin{itemize}
    \item \textbf{Fact Table:} \texttt{sdr\_landing\_gear} (Grain: Daily Defect).
    \item \textbf{Dimension Tables:} \texttt{DateTable} (DAX) and \texttt{US\_Temp\_Data} (Monthly).
    \item \textbf{The Bridge Strategy:} The Temperature data (Monthly) could not join directly to Defects (Daily). I joined both to the \texttt{DateTable} and enabled \textbf{Bi-Directional Cross-Filtering} to ensure monthly slicers propagated correctly to the temperature trend line.
\end{itemize}

% --- IMAGE 2: DATA MODEL ---
% REPLACE THE CODE BELOW WITH: \includegraphics[width=0.8\textwidth]{data_model_schema.png}
\begin{figure}[h!]
  \centering
  \framebox{\parbox{0.8\textwidth}{\centering
    \vspace{2cm}
    \textbf{INSERT SCREENSHOT: data\_model\_schema.png} \\
    \small\textit{Show the Star Schema relationships and Bridge Table.}
    \vspace{2cm}
  }}
  \caption{Star Schema Architecture ensuring accurate cross-filtering.}
  \label{fig:schema}
\end{figure}

\section{Advanced Analytics (DAX Logic)}

\subsection{1. Seasonality Detection (3-Month Moving Average)}
A rolling average was applied to smooth out daily volatility and reveal the summer failure spike.

\begin{minipage}{\linewidth}
\begin{lstlisting}
3-Month Trend = 
VAR RollingTotal = CALCULATE(
    [Total Defects],
    DATESINPERIOD('DateTable'[Date], MAX('DateTable'[Date]), -3, MONTH)
)
RETURN RollingTotal / 3  -- Fixed division logic
\end{lstlisting}
\end{minipage}

\subsection{2. Risk Index Scoring (Calculated Column)}
Automated logic classified severity based on text keywords to prioritize "Safety Critical" issues.

\begin{minipage}{\linewidth}
\begin{lstlisting}
Severity Score = SWITCH( TRUE(),
    CONTAINSSTRING([PartCondition], "FIRE") || 
    CONTAINSSTRING([PartCondition], "SHEAR"), 10,  // Critical
    CONTAINSSTRING([PartCondition], "LEAK") || 
    CONTAINSSTRING([PartCondition], "FAIL"), 5,     // Operational
    1 // Nuisance
)
\end{lstlisting}
\end{minipage}

\section{Key Results \& Strategic Impact}
\begin{itemize}
    \item \textbf{Root Cause Discovery:} Correlated defect rates with temperature data, identifying a \textbf{40\% surge} in Brake/Tire failures during summer (July peak).
    \item \textbf{Operational Risk Quantification:} Quantified that \textbf{96\%} of reported defects (473/491) resulted in immediate grounding (AOG), validating the financial necessity of a preventative maintenance program.
    \item \textbf{Maintenance Strategy Shift:} Discovered that \textbf{57\%} of defects were functional/sensor issues, driving a shift in training toward avionics troubleshooting rather than structural repair.
\end{itemize}

\clearpage

\section{Visual Experience}
The dashboard utilized the \textbf{Boeing Brand Palette} (\texttt{\#0039A6} Blue, \texttt{\#D62620} Red) for executive clarity.

\begin{itemize}
    \item \textbf{Drill-Through Audit:} Users right-click specific failure bars (e.g., "Brakes") to access a hidden "Defect Log." This allows engineers to trace a high-level trend directly back to the specific \textbf{Aircraft Tail Number} and mechanic's notes for root cause verification.
    \item \textbf{Temperature Trend Analysis:} Engineered a dual-axis Combo Chart to visually prove the correlation between heat spikes and component failure.
\end{itemize}

% --- IMAGE 3: TREND CHART ---
% REPLACE THE CODE BELOW WITH: \includegraphics[width=\textwidth]{trend_chart.png}
\begin{figure}[h!]
  \centering
  \framebox{\parbox{0.9\textwidth}{\centering
    \vspace{3cm}
    \textbf{INSERT SCREENSHOT: trend\_chart.png} \\
    \small\textit{Show the Combo Chart with Defects (Bars) and Temperature (Line).}
    \vspace{3cm}
  }}
  \caption{Temperature vs. Defect correlation analysis revealing the July spike.}
  \label{fig:trend}
\end{figure}

\end{document}